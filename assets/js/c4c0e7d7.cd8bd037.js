"use strict";(self.webpackChunkproxily_doc=self.webpackChunkproxily_doc||[]).push([[290],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return y}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=l(n),y=r,h=d["".concat(c,".").concat(y)]||d[y]||p[y]||o;return n?a.createElement(h,s(s({ref:t},u),{},{components:n})):a.createElement(h,s({ref:t},u))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2811:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return u},default:function(){return d}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),s=["components"],i={title:"Asynchronous",sidebar_position:3},c=void 0,l={unversionedId:"Features/async",id:"Features/async",isDocsHomePage:!1,title:"Asynchronous",description:"Promises",source:"@site/docs/Features/async.md",sourceDirName:"Features",slug:"/Features/async",permalink:"/proxily/docs/Features/async",editUrl:"https://github.com/selsamman/proxily-doc/edit/master/website/docs/Features/async.md",version:"current",sidebarPosition:3,frontMatter:{title:"Asynchronous",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Persistence & Serialization",permalink:"/proxily/docs/Features/persistence"},next:{title:"Transactions",permalink:"/proxily/docs/Features/transactions"}},u=[{value:"Promises",id:"promises",children:[]},{value:"Sagas",id:"sagas",children:[]}],p={toc:u};function d(e){var t=e.components,n=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"promises"},"Promises"),(0,o.kt)("p",null,"Since actions are just normal member functions they can be asynchronous:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"class CounterState {\n  value = 0;\n  async delayedIncrement () {\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    this.value++\n  }\n}\n")),(0,o.kt)("h2",{id:"sagas"},"Sagas"),(0,o.kt)("p",null,"In some instances you have more complex asynchronous behavior or situations where promises are inadequate. Redux-saga has a rich tool-kit for organizing asynchronous behavious using generators.  Proxily integrates with redux-sagas to bring these benefits to Proxily without using redux as a store.  "),(0,o.kt)("p",null,'While redux-sagas is based on "listening" for actions, with Proxily you start with a generator function that can have multiple yields for each asynchronous step of the task.  This represents a type of task that can be scheduled'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"  function *worker({interval, type} : {interval : number, type : string}) {\n      yield delay(interval);\n      // Do something\n  }\n")),(0,o.kt)("p",null,"You then schedule an instance of that task"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  scheduleTask(worker, {interval: 150, type: 'A'}, takeEvery);\n")),(0,o.kt)("p",null,"The parameters are passed as an object and our received in the task function."),(0,o.kt)("p",null,"When you schedule it you chose one of the take helpers such as takeEvery, takeLeading, debounce, throttle to indicate how the scheduling should deal with concurrent invocation of the task.  See the ",(0,o.kt)("a",{parentName:"p",href:"/proxily/docs/API/async#scheduletask"},(0,o.kt)("strong",{parentName:"a"},"scheduleTask"))," for details."),(0,o.kt)("p",null,"Sagas are object and class friendly because the sagas, which are member functions, are automatically bound by Proxily to their target object."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"class Container {\n    *task({interval} : {interval : number}) {\n        yield delay(interval);\n    }\n    invokeTask () {\n        scheduleTask(this.task, {interval: 1000}, takeLeading); //sequentialize\n    }\n}\nconst container = makeObservable(new Container());\ncontainer.invokeTask();\n")),(0,o.kt)("p",null,"If using an effect that takes a time parameter like throttle or debounce you can pass it in:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"scheduleTask(this.task, {interval: 1000}, debounce, 500);\n")),(0,o.kt)("p",null,"You can cancel a task if you don't want it to run for the duration of your application.  You must pass the same take helper since this is used to locate the task:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"}," cancelTask(this.task, takeLeading);\n")),(0,o.kt)("p",null,"And if you want a more exotic use of sagas just pass in your own take effect.  Here is the example for takeEvery"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'const takeLeadingCustom = (patternOrChannel:any, saga:any, ...args:any) => fork(function*() {\n    while (true) {\n        const action : any = yield take(patternOrChannel);\n        yield call(saga, ...args.concat(action));\n        console.log("foo");\n    }\n})\n...\nscheduleTask(this.task, {interval: 1000}, takeLeadingCustom);\n\n')))}d.isMDXComponent=!0}}]);