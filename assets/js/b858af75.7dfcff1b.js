"use strict";(self.webpackChunkproxily_doc=self.webpackChunkproxily_doc||[]).push([[730],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return m}});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(r),m=i,g=d["".concat(l,".").concat(m)]||d[m]||u[m]||a;return r?n.createElement(g,s(s({ref:t},p),{},{components:r})):n.createElement(g,s({ref:t},p))}));function m(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,s=new Array(a);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var c=2;c<a;c++)s[c]=r[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},3511:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var n=r(7462),i=r(3366),a=(r(7294),r(3905)),s=["components"],o={title:"Persistence",sidebar_position:4},l=void 0,c={unversionedId:"Features/persistence",id:"Features/persistence",isDocsHomePage:!1,title:"Persistence",description:"Proxily will integrate with any storage object that supports getItem and setItem.  Specifically this includes localStorage and sessionStorage.  To integrate with storage use persist to read from storage, merge with an initial state, set up a proxy and observe any changes to the proxy and write back to storage",source:"@site/docs/Features/persistence.md",sourceDirName:"Features",slug:"/Features/persistence",permalink:"/proxily/docs/Features/persistence",editUrl:"https://github.com/selsamman/proxily-doc/edit/master/website/docs/Features/persistence.md",version:"current",sidebarPosition:4,frontMatter:{title:"Persistence",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Serialization",permalink:"/proxily/docs/Features/serialization"},next:{title:"Transactions",permalink:"/proxily/docs/Features/transactions"}},p=[],u={toc:p};function d(e){var t=e.components,r=(0,i.Z)(e,s);return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Proxily will integrate with any storage object that supports getItem and setItem.  Specifically this includes localStorage and sessionStorage.  To integrate with storage use ",(0,a.kt)("strong",{parentName:"p"},"persist")," to read from storage, merge with an initial state, set up a proxy and observe any changes to the proxy and write back to storage"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"const stateProxy = persist(state, {classes: [Class1, Class2]});\n")),(0,a.kt)("p",null,"The first parameter to persist is the initial state which is any structure supported by Proxily including plane objects or class based hierarchies.  The second parameter is the configuration which may include these properties:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"storageEngine")," - Any storage engine that supports getItem and setItem. Defaults to localStorage."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"classes")," - An array of classes used in the structure just as for deserialize"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"migrate")," - A function which is passed the persisted state and the initial state and should return the new state.  It might, for example, enhance the persisted state to bring it up-to-date with the current application requirements and then merge it using the default merge routine exported from Proxily")),(0,a.kt)("p",null,"The default migration logic will merge initial and persistent states giving preference to the persistent state.  It will merge multiple levels up to but not including properties of built-in objects or Arrays."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import {migrate, persist} from 'proxily';\nconst classes = [TodoList, TodoListItem];\nconst persistedObservableState = persist(state, {classes , migrate: myMigrate});\nfunction myMigrate (persist, initial) {\n    delete persist.description; // unused property\n    return migrate(persist, initial);\n}\n")),(0,a.kt)("p",null,"Note:  persist will also make the state returned observable so there is no need to additionally call makeObservable."))}d.isMDXComponent=!0}}]);